<div id="room">
    <div id="player-1-info">
        <div id="player-1-container" class="center">
            1
        </div>
        <div id="player-1-username-container" class="center">
            <div>
                <div id="player-1-username">
                        
                </div>
                <div class="win-container center">
                    <div id="player-1-win-1" class="player-1-wins win-mr win-size"></div>
                    <div id="player-1-win-2" class="player-1-wins win-size" ></div>
                </div>
            </div>
        </div>      
    </div>
    <div id="ttt-container">
        <div id="ttt-board-container">
            <div id="ttt-board">
                <div class="ttt-row">
                    <div id='block-0' class="ttt-block" onclick="tictactoeBoard(0)" onmouseover="tictactoeSymbolOver(event)" onmouseleave="tictactoeSymbolOut(event)"></div>
                    <div id='block-1' class="ttt-block" onclick="tictactoeBoard(1)" onmouseover="tictactoeSymbolOver(event)" onmouseleave="tictactoeSymbolOut(event)"></div>
                    <div id='block-2' class="ttt-block" onclick="tictactoeBoard(2)" onmouseover="tictactoeSymbolOver(event)" onmouseleave="tictactoeSymbolOut(event)"></div>
                </div>
                <div class="ttt-row">
                    <div id='block-3' class="ttt-block" onclick="tictactoeBoard(3)" onmouseover="tictactoeSymbolOver(event)" onmouseleave="tictactoeSymbolOut(event)"></div>
                    <div id='block-4' class="ttt-block" onclick="tictactoeBoard(4)" onmouseover="tictactoeSymbolOver(event)" onmouseleave="tictactoeSymbolOut(event)"></div>
                    <div id='block-5' class="ttt-block" onclick="tictactoeBoard(5)" onmouseover="tictactoeSymbolOver(event)" onmouseleave="tictactoeSymbolOut(event)"></div>
                </div>
                <div class="ttt-row">
                    <div id='block-6' class="ttt-block" onclick="tictactoeBoard(6)" onmouseover="tictactoeSymbolOver(event)" onmouseleave="tictactoeSymbolOut(event)"></div>
                    <div id='block-7' class="ttt-block" onclick="tictactoeBoard(7)" onmouseover="tictactoeSymbolOver(event)" onmouseleave="tictactoeSymbolOut(event)"></div>
                    <div id='block-8' class="ttt-block" onclick="tictactoeBoard(8)" onmouseover="tictactoeSymbolOver(event)" onmouseleave="tictactoeSymbolOut(event)"></div>
                </div>
            </div>
        </div>
        <div id="ttt-board-current-player" class="center">
            Player turn
        </div>
    </div>
    <!-- mobile -->
    <div id="mobile-players-details">
        <div id="player-1-info-mobile">
            <div id="player-1-container-mobile" class="center">
                1
            </div>
            <div id="player-1-username-container-mobile" class="center">
                <div>
                    <div id="player-1-username-mobile">
                    
                    </div>
                    <div class="win-container center">
                        <div id="player-1-win-1-mobile" class="player-1-wins win-mr win-mobile-size"></div>
                        <div id="player-1-win-2-mobile" class="player-1-wins win-mobile-size"></div>
                    </div>
                </div>
            </div>  
        </div>
        <div id="ttt-board-current-player-mobile" class="center">
            player turn
        </div>
        <div id="player-2-info-mobile">
            <div id="player-2-container-mobile" class="center">
                2
            </div>
            <div id="player-2-username-container-mobile" class="center">
                <div>
                    <div id="player-2-username-mobile">
                    
                    </div>
                    <div class="win-container center">
                        <div id="player-2-win-1-mobile" class="player-2-wins win-mr win-mobile-size"></div>
                        <div id="player-2-win-2-mobile" class="player-2-wins win-mobile-size"></div>
                    </div>
                </div>
            </div>  
        </div>
    </div>
    <div id="player-2-info">
        <div id="player-2-container" class="center">
            2
        </div>
        <div id="player-2-username-container" class="center">
            <div>
                <div id="player-2-username">
                        
                </div>
                <div class="win-container center">
                    <div id="player-2-win-1" class="player-2-wins win-mr win-size"></div>
                    <div id="player-2-win-2" class="player-2-wins win-size"></div>
                </div>
            </div>
        </div>    
    </div>
</div>

<style>
    #winner-player{

    }
    #rematch-prompt-container{
        margin-bottom: 20px;
    }
    #rematch-true-btn{
        font-size: 20px;
        margin-right: 10px;
    }
    #rematch-false-btn{
        font-size: 20px;
    }
</style>
<div id="ttt-prompts-containers">
    <div id="ttt-prompts-placeholder">
        <div id="winner-rematch-container">
            <!-- Modal -->
            <div class="modal fade" id="winnerRematchModal" tabindex="-1" role="dialog" aria-labelledby="rematchModal" aria-hidden="true" data-backdrop="static">
                <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                    <div class="modal-body center">
                        <div>
                            <div id="winner-player-container">
                                <div id="winner-player">Winner</div>
                            </div>
                            <div id="winner-rematch-prompt-container" class="center">
                                <div id="winner-rematch-prompt">Rematch</div>
                            </div>
                            <div id="winner-rematch-btn-container" class="center">
                                <button id="winner-rematch-true-btn" class="btn btn-primary mr-5" onclick="rematch(true)">Play Again</button>
                                <button id="winner-rematch-false-btn" class="btn btn-secondary" onclick="rematch(false)">Exit</button>
                            </div>
                        </div>
                    </div>
                </div>
                </div>
            </div>
        </div>
        <div id="rematch-container">
            <!-- Modal -->
            <div class="modal fade" id="rematchModal" tabindex="-1" role="dialog" aria-labelledby="rematchModal" aria-hidden="true" data-backdrop="static">
                <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                    <div class="modal-body center">
                        <div>
                            <div id="rematch-prompt-container" class="center">
                                <div id="rematch-prompt">Rematch</div>
                            </div>
                            <div id="rematch-btn-container" class="center">
                                <button id="rematch-true-btn" class="btn btn-primary mr-5" onclick="rematch(true)">Play Again</button>
                                <button id="rematch-false-btn" class="btn btn-secondary" onclick="rematch(false)">Exit</button>
                            </div>
                        </div>
                    </div>
                </div>
                </div>
            </div>
        </div>
        <div id="opponent-lost-connection-container">
            <div id="opponent-lost-connection" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="lostConnectionModal" aria-hidden="true" data-backdrop="static">
                <div class="modal-dialog modal-dialog-centered" role="document">
                    <div class="modal-content">
                        <div class="modal-body center">
                            <div>
                                <h1 id="opponent-lost-connection-title" class="center">Lost Connection</h1>
                                <div id="opponent-lost-connection">Redirect in <span id="second-to-redirect-lost-connection">5</span> seconds</div>
                            </div>
                        </div>
                    </div>
                    </div>
            </div>
        </div>
        <div id="player-declined-rematch-container">
            <div id="player-declined-rematch" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="rematchModal" aria-hidden="true" data-backdrop="static">
                <div class="modal-dialog modal-dialog-centered" role="document">
                    <div class="modal-content">
                        <div class="modal-body center">
                            <div>
                                <h1 id="player-declined-rematch-title" class="center">Player Declined Rematch</h1>
                                <div id="player-redirect">Redirecting in <span id="second-to-redirect">5</span> seconds</div>
                            </div>
                        </div>
                    </div>
                    </div>
            </div>
        </div>
        <div id="set-winner-container">
            <div id="setWinnerModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="rematchModal" aria-hidden="true" data-backdrop="static">
                <div class="modal-dialog modal-dialog-centered" role="document">
                    <div class="modal-content">
                        <div class="modal-body">
                            <div id="set-winner-content" class="center">
                                <div>
                                    <div class="mb-4">
                                        <h1 id="set-winner-title" class="center"></h1>
                                    </div>
                                    <div class="center">
                                        <button id="back-home" onClick="returnHome()">Back Home</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    </div>
            </div>
        </div>
        <div id="searching-for-player-container">
            <div id="searching-for-player"></div>
        </div>
        <div id="wait-player-choose-turn-prompt-container">
            <div id="wait-for-player"></div>
        </div>
        <div id="player-turn-prompt-container">
            <!-- Modal -->
            <div class="modal fade" id="player-turn-modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true" data-backdrop="static">
                <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                    <div class="modal-body center">
                        <div>
                            <div>
                                <div id="title-prompt-container">
                                    Please Choose Turn:
                                </div>
                            </div>
                            <div>
                                <button id="first-turn-btn" class="btn btn-primary mr-5" onclick="chooseTurnPrompt('first')">First Turn</button>
                                <button id="second-turn-btn" class="btn btn-secondary" onclick="chooseTurnPrompt('second')">Second Turn</button>
                            </div>
                        </div>
                    </div>
                </div>
                </div>
            </div>
        </div>
        <div id="wait-player-choose-symbol-prompt-container">
            <div id="wait-for-player-choose-symbol"></div>
        </div>
        <div id="choose-symbol-prompt-container">
            <!-- Modal -->
            <div class="modal fade" id="chooseSymbolModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true" data-backdrop="static">
                <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                    <div class="modal-body center">
                        <div>
                            <div>
                                <div id="choose-symbol-title-prompt-container">
                                    Please Choose Symbol:
                                </div>
                            </div>
                            <div class="center">
                                <button id="X-btn" class="btn btn-primary mr-5" onclick="chooseSymbol('X')">(X)</button>
                                <button id="O-btn" class="btn btn-secondary" onclick="chooseSymbol('O')">(O)</button>
                            </div>
                        </div>
                    </div>
                </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    function returnHome(){
        window.location.href = '/';
    }
    function chooseSymbol(symbol){
        socket.emit('set-players-symbols',{playerSymbolChoosen:symbol});
        // $('#chooseSymbolModal').modal('hide')
        socket.emit('choose-turn-prompt-session',{});
    }
    function tictactoeSymbolOver(event){
        if(event.target.className=='ttt-block'){
            var {playerSymbol}=JSON.parse(localStorage.getItem('tttPlayerInfo'));
            event.target.style.zIndex="9999";
            if(playerSymbol=='O'){
                event.target.innerHTML="<div class='temp-symbol o-symbol center w-100 h-100' style='z-index:-2;'><i class='far fa-circle' style='z-index:-2;'></i></div>";
            }
            else if(playerSymbol=='X'){
                event.target.innerHTML="<div class='temp-symbol x-symbol center w-100 h-100' style='z-index:-2;'><i class='fas fa-times' style='z-index:-2;'></i></div>";
            }
        }
    }
    function tictactoeSymbolOut(event){
        if(event.target.children[0].className=='temp-symbol x-symbol center w-100 h-100'){
            event.target.innerHTML='';
        }
        else if(event.target.children[0].className=='temp-symbol o-symbol center w-100 h-100'){
            event.target.innerHTML='';
        }
    }
    
    function updateBoard(board){
        for(var i=0; i<board.length;i++){
            var tttBoardCurrentPlayer=document.getElementById("block-"+i);
            if(board[i]!=null){
                if(board[i]=='X'){
                    tttBoardCurrentPlayer.innerHTML="<div class='x-symbol center w-100 h-100'><i class='fas fa-times'></i></div>";
                }
                else if(board[i]=='O'){
                    tttBoardCurrentPlayer.innerHTML="<div class='o-symbol center w-100 h-100'><i class='far fa-circle'></i></div>";
                }
            }
            else{
                tttBoardCurrentPlayer.innerHTML="";
            }
        }
    }

function toggleTttPrompts(promptToShow){
    var waitPlayerChooseSymbolContainer=document.getElementById('wait-player-choose-symbol-prompt-container');
    var chooseSymbolContainer=document.getElementById('choose-symbol-prompt-container');
    var setWinnerContainer=document.getElementById('set-winner-container');
    var rematchContainer=document.getElementById('rematch-container');
    var winnerRematchContainer=document.getElementById('winner-rematch-container');
    var playerDeclinedRematchContainer=document.getElementById('player-declined-rematch-container');
    var opponentLostConnectionContainer=document.getElementById('opponent-lost-connection-container');
    var searchingForPlayerContainer=document.getElementById('searching-for-player-container');
    var waitPlayerChooseTurnPromptContainer=document.getElementById('wait-player-choose-turn-prompt-container');
    var playerTurnPromptContainer=document.getElementById('player-turn-prompt-container');
    var chooseSymbolModalDivSelector=document.getElementById('chooseSymbolModal');
    if(promptToShow=='none'){
        $('#chooseSymbolModal').modal('hide');
        $('#rematchModal').modal('hide');
        $('#lostConnectionModal').modal('hide');
        $('#player-declined-rematch-container').modal('hide');
        $('#opponent-lost-connection').modal('hide');
        $('#player-turn-modal').modal('hide');
        setWinnerContainer.style.display="none";
        rematchContainer.style.display="none";
        winnerRematchContainer.style.display="none";
        searchingForPlayerContainer.style.display="none";
        waitPlayerChooseTurnPromptContainer.style.display="none";
        playerTurnPromptContainer.style.display="none";
        playerDeclinedRematchContainer.style.display="none";
        chooseSymbolContainer.style.display="none";
        waitPlayerChooseSymbolContainer.style.display="none";
        opponentLostConnectionContainer.style.display="none";
    }
    else if(promptToShow=='waitPlayerChooseSymbolContainer'){
        waitPlayerChooseSymbolContainer.style.display="display";
    }
    else if(promptToShow=='chooseSymbolContainer'){
        // alert('inside choose symbol from room ejs');
        chooseSymbolContainer.style.display="flex";
        $('#chooseSymbolModal').modal('show');
    }
    else if(promptToShow=='setWinnerContainer'){
        setWinnerContainer.style.display="flex";
        $('#setWinnerModal').modal('show');
    }
    else if(promptToShow=='waitPlayerChooseTurnPromptContainer'){
        waitPlayerChooseTurnPromptContainer.style.display="flex";
        waitPlayerChooseTurnPromptContainer.style.zIndex='9999';
    }
    else if(promptToShow=='opponentLostConnectionContainer'){
        chooseSymbolContainer.style.display="none";
        $('#chooseSymbolModal').modal('hide');
        opponentLostConnectionContainer.style.display="flex";
        $('#opponent-lost-connection').modal('show');
    }
    else if(promptToShow=='playerDeclinedRematchContainer'){
        playerDeclinedRematchContainer.style.display="flex";
        $('#player-declined-rematch').modal('show');
    }
    else if(promptToShow=='rematchContainer'){
        rematchContainer.style.display="flex";
        $('#rematchModal').modal('show');
    }
    else if(promptToShow=='winnerRematchContainer'){
        winnerRematchContainer.style.display="flex";
        $('#winnerRematchModal').modal('show');
    }
    else if(promptToShow=='searchingForPlayerContainer'){
        $('#chooseSymbolModal').modal('hide');
    }
    else if(promptToShow=='playerTurnPromptContainer'){
        playerTurnPromptContainer.style.display="flex";
        $('#player-turn-modal').modal('show');
    }
}
</script>
<script src="../js/room/roomSession.js"></script>
<script src="../js/room/chooseSymbolPromptSession.js"></script>
<script src="../js/room/chooseTurnPromptSession.js"></script>
<script src="../js/room/setPlayersTurns.js"></script>
<script src="../js/room/tictactoeStartGame.js"></script>
<script src="../js/room/tictactoeGame.js"></script>
<script src="../js/room/rematch.js"></script>
<script src="../js/room/connection.js"></script>
<script src="../js/room/tictactoeGameEnd.js"></script>